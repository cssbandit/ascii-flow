<!DOCTYPE html>
<html>
<head>
    <title>Font Metrics Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background: #f5f5f5; }
        .test-char { 
            font-family: 'Courier New', monospace; 
            background: #eee; 
            border: 1px solid #999;
            display: inline-block;
            text-align: center;
        }
    </style>
</head>
<body>
    <h2>ASCII Motion Font Metrics Analysis</h2>
    <p>This test measures character dimensions for monospace fonts to determine proper aspect ratios.</p>
    
    <div id="results"></div>
    
    <h3>Visual Test Characters</h3>
    <div id="visual-test"></div>
    
    <script>
        function measureCharacter(fontFamily, fontSize) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.font = `${fontSize}px ${fontFamily}`;
            
            // Measure typical ASCII characters
            const chars = ['M', 'W', 'i', 'l', '█', '▓', '░'];
            const measurements = {};
            
            chars.forEach(char => {
                const metrics = ctx.measureText(char);
                const height = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;
                measurements[char] = {
                    width: metrics.width,
                    height: height,
                    aspectRatio: metrics.width / height
                };
            });
            
            return measurements;
        }
        
        const fonts = ['Courier New', 'Monaco', 'Menlo', 'SF Mono', 'Consolas'];
        const sizes = [10, 12, 14, 16, 18, 20];
        
        let html = '<table><tr><th>Font</th><th>Size</th><th>Char</th><th>Width</th><th>Height</th><th>Aspect Ratio</th></tr>';
        
        fonts.forEach(font => {
            sizes.forEach(size => {
                const measurements = measureCharacter(font, size);
                Object.entries(measurements).forEach(([char, metrics]) => {
                    html += `<tr>
                        <td>${font}</td>
                        <td>${size}px</td>
                        <td style="font-family: ${font}; font-size: ${size}px;">${char}</td>
                        <td>${metrics.width.toFixed(2)}</td>
                        <td>${metrics.height.toFixed(2)}</td>
                        <td><strong>${metrics.aspectRatio.toFixed(3)}</strong></td>
                    </tr>`;
                });
            });
        });
        
        html += '</table>';
        document.getElementById('results').innerHTML = html;
        
        // Visual test
        const visualSizes = [10, 12, 14, 16, 20];
        let visualHtml = '';
        visualSizes.forEach(size => {
            visualHtml += `<div style="margin: 10px 0;">
                <strong>${size}px:</strong>
                <span class="test-char" style="font-size: ${size}px; width: ${size}px; height: ${size}px;">█</span>
                <span class="test-char" style="font-size: ${size}px; width: ${size * 0.6}px; height: ${size}px;">█</span>
                <span style="margin-left: 10px;">Square vs 0.6 aspect ratio</span>
            </div>`;
        });
        document.getElementById('visual-test').innerHTML = visualHtml;
        
        // Calculate common aspect ratio
        const commonMeasurements = measureCharacter('Courier New', 12);
        const avgAspectRatio = Object.values(commonMeasurements).reduce((sum, m) => sum + m.aspectRatio, 0) / Object.keys(commonMeasurements).length;
        
        console.log('Average aspect ratio for Courier New 12px:', avgAspectRatio.toFixed(3));
        console.log('Recommended cell dimensions for 12px font:', {
            width: 12 * 0.6,
            height: 12,
            aspectRatio: 0.6
        });
    </script>
</body>
</html>
